<template>
	<view class="kw-search">
    <!-- 蒙版 -->
    <view class="kw-search-mask" v-show="ifFocus == true" @tap="cancel"></view>
    <view class="kw-search-body">
      <!-- 输入框 -->
      <view v-if="inputShow" class="kw-search-content" @tap="tapFocus()" >
        <view class="kw-search-icon" v-show="ifFocus == false">
          <uni-icon type="search" size="25" color="#b0b0b0" ></uni-icon>
        </view>
        <view class="kw-search-input">
          <input :placeholder="placeholder" adjust-position :value="value" @input="inputChange"/>
        </view>
      </view>
      <!-- 取消 -->
      <!-- <view v-show="ifFocus == true" class="kw-search-cancel" :class="{kwSearchIsinput: !inputShow}"
            @tap="cancel" >取消</view> -->
      <!-- 选择区 -->
      <view class="kw-search-slot" v-show="ifFocus == true" :class="{kwSearchIsinput: !isInput}">
        <slot name="content"></slot>
        <button class="kw-search-slot-button" type="primary" @tap="confirm">确定</button>
      </view>
    </view>
    
    
	</view>
</template>

<script>
  import KwListCell from "@kwz/kw-ui/kw-list-cell.vue"

	export default {
		data() {
			return {
				ifFocus: false ,// 是否点击输入框
				inputShow: true
			};
		},
    components:{KwListCell},
    props: {
      value: {
				default: '',
				type: String
			}, // 搜索框值
      placeholder: { // 搜索框占位符
        type: String,
        default: "请输入"
      },
      // 是否要输入框
      isInput: {
        type: [Boolean, String],
        default: true
      }
    },
    methods:{
			//点击输入框
      tapFocus(){
        this.ifFocus = true
        if(!this.isInput){
          this.inputShow = false;
        }
      },
      // 输入搜索时改变量
      inputChange(e){
        this.value = e.target.value
      },
      // 取消
      cancel() {
        this.ifFocus = false
				this.inputShow = true
        this.$emit("cancel")
      },
      // 确定 callback:输入框输入内容
      confirm(){
        this.ifFocus = false
				this.inputShow = true
        this.$emit("confirm",{
          value: this.value
        })
      }
    }
	}
</script>

<style lang="scss">
  .kw-search{
    z-index: 999;
    position: sticky;
    top:44px;
    /* #ifdef MP-WEIXIN */
    top:0;
    /* #endif */
  }
  .kw-search-body{
    height: 100upx;
    background: white;
    z-index: 1001;
    width: 100%;
    display: flex;
    flex-direction: row;
    padding: 20upx;
    position: relative;
  }
  .kw-search-content{
    background: #eeeeee;
    height: 100%;
    flex-basis: 100%;
    border-radius: 5upx;
    display: flex;
    flex-direction: row;
    flex-shrink:2;
    .kw-search-icon{
      height: 100%;
      width: 60upx;
      display: flex;
      justify-content:center;
      align-items: center;
    }
    .kw-search-input{
      flex-basis: 650upx;
      display: flex;
      justify-content:center;
      align-items: center;
      flex-shrink:2;
      padding: 0 10upx;
      input{
        flex-basis: 100%;
        color:#9a9a9a;
      }
    }
  }
  .kw-search-cancel{
    width: 100upx;
    display: flex;
    justify-content:center;
    align-items: center;
  }
  .kw-search-slot{
    border-top: #dedede solid 2upx;
    position: absolute;
    top: 100upx;
    width: 100%;
    left: 0;
    padding: 20upx 0;
    background: white;
    .kw-search-slot-button{
      background: #01a1eb;
      height: 80upx;
      margin: 20upx 20upx 0;
      line-height: 80upx;
    }
  }
  .kwSearchIsinput{
    top:0;
    padding-top: 0;
  }
  .kw-search-mask{
    z-index: 999;
    position: fixed;
    background: rgba(0, 0, 0, 0.5);
    height: calc(100vh - 44px);
    width: 100%;
    top: 44px;
    left: 0;
    /* #ifdef MP-WEIXIN */
    height: 100vh;
    top: 0;
    /* #endif */
  }
</style>
