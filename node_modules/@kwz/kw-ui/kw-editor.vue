<template>
	<view class="kw-editor">
    <!-- 输入框 -->
		<view class="kw-editor-content">
			<textarea class="kw-editor-content-textarea" :value="content.content" @blur="changeEditor" maxlength="4000"></textarea>
		</view>
    <!-- 图片组 -->
		<view class="kw-editor-images">
      <!-- 添加按钮 -->
      <view class="kw-editor-img">
        <view class="kw-editor-img-content">
          <view class="kw-editor-add">
            <uni-icon type="plusempty" color="#c8c7cc"></uni-icon>
            <view class="kw-editor-add-info">点击添加图片</view>
          </view>
        </view>
      </view>
      <!-- 以下是图片 -->
      <view class="kw-editor-img">
        <view class="kw-editor-img-content">
          <!-- 删除按钮 -->
          <view class="kw-editor-del">
            <uni-icon type="closeempty" size="40" color="red"></uni-icon>
          </view>
        </view>
      </view>
		</view>	
  </view>
</template>

<script>
  import {uniIcon} from '@dcloudio/uni-ui'

  export default {
		name: 'editor',
		components:{uniIcon},
		data () {
			return {
				// content: []
			}
		},
    props:{
      content: {
				type: Object,
				default () {
					return {
						content: '',
						images: []
					}
				}
			}
    },
		methods:{
			addImage () {
				this.$kwz.uploadImage({
				},{
					url: 'ueditor/jsp/controller.jsp?action=uploadimage',
					success (image, tempImage) {
						if (image && image.url) {
							this.content.images.push({
								type: 'image',
								content: this.$kwz.ajax.url(image.url),
								imageUrl : image.url
							})
						}
					}
				}, this)
			},
			removeImage (index) {
// 				let contentLength = this.content.length;
// 				let content = []
// 				for (let i = 0 ;i < contentLength; i++) {
// 					if (i < (index - 1) || i > index + 1) {
// 						content.push(this.content[i])
// 					} else {
// 						if (this.content[index -1].type == 'textarea' && this.content[index + 1].type == 'textarea') {
// 							this.content[index -1].content += this.content[index + 1].content
// 							content.push(this.content[index -1])
// 						} else {
// 							content.push(this.content[index -1])
// 							content.push(this.content[index +1])
// 						}
// 						i += 2
// 					}
// 				}
// 				this.content = content
			},
			addVideo () {
			},
			changeEditor (e) {
				this.content.content = e.detail.value
			}
		}
  }
</script>

<style lang="scss">
  .kw-editor{
    position: relative;
    width: 100%;
    min-height: 600upx;
    border:#dddddd solid 1upx;
    display: flex;
    flex-direction: column;
  }
	.kw-editor-content{
		.kw-editor-content-textarea{
			padding: 8upx;
			border-bottom:#dddddd solid 1upx;
			height: 400upx;
			width: 100%
		}
	}
  .kw-editor-images{
    display: flex;
    flex-direction: row;
    height: 200upx;
    padding: 8upx;
    width: 100%;
    overflow: auto;
    .kw-editor-img{
      padding: 6upx 37upx;
      width: 244upx;
      height: 182upx;
      .kw-editor-img-content{
        background:#f3f2f3;
        border: 1upx solid #c8c7cc;
        height: 100%;
        width:100%;
        position: relative;       
      }
      .kw-editor-del{
        position: absolute;
        top:-15upx;
        right: -15upx;
      }
      .kw-editor-add{
        position: relative;
        .kw-editor-add-info{
          position: absolute;
          bottom: 7upx;
          text-align: center;
          font-size:20upx;
          color: #999999;
          width: 100%;
        }
        .uni-icon{
          font-size: 170upx;
        }
      }
      image{
        width:100%;
        height: 100%;
      }
    }
  }
</style>
